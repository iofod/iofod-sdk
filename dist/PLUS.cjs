"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});let f;const u={},c={},p=["EditorUndo","EditorRedo","EditorPreview","EditorExitPreview"];function C(e,t){if(typeof t=="function"&&(u[e]?u[e].push(t):u[e]=[t],!c[e])){const r=p.includes(e)?e:f+":"+e;c[e]=new BroadcastChannel(r),c[e].onmessage=n=>{u[e].forEach(a=>{a(n.data)})}}}function A(e,t){!u[e]||(typeof t=="function"&&u[e].includes(t)?(u[e].splice(u[e].indexOf(t),1),u[e].length||c[e].close()):(delete u[e],c[e].close(),delete c[e]))}function h(e,t){const r=n=>{t(n),setTimeout(()=>{A(e,r)},0)};C(e,r)}function g(e){f||(f=e)}const I="PLUS:",i=()=>((1+Math.random())*65536|0).toString(16).substring(1),L=()=>i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i();function s(e,t,r){const n=L();return postMessage({type:I+e,payload:t,id:n}),typeof r=="function"&&h(n,r),n}function b(e){return new Promise(t=>{if(!e)return t(!1);s("ACCESS:CHECK",{ql:e},r=>{t(r)})})}function w(){return new Promise(e=>{s("ACCESS:CHECK",{ql:"ALL"},t=>{e(t)})})}function E(e=[]){return new Promise(t=>{s("ACCESS:REQUEST",{list:e},r=>{t(r)})})}async function y(e=[]){const t=await w();return!!(e.every(n=>t.includes(n))||(await E(e)).code==0)}const P=()=>Math.random().toString(36).substring(2);function U(e="W"){return e+Math.round((Date.now()-new Date("2020/02/02").getTime())/1e3)+P().substring(0,3)}function O(e="CTT"){return new Promise(t=>{s("DATA:GET",{path:e},r=>{t(r)})})}function k(e="CTT",t={}){return new Promise(r=>{s("DATA:SET",{path:e,payload:t},n=>{r(n)})})}function x(){return new Promise(e=>{s("DATA:GET_CURRENT_STYLE",{payload:{}},t=>{e(t)})})}function D(e){return new Promise(t=>{s("DATA:SET_CURRENT_STYLE",{payload:e},r=>{t(r)})})}function H(...e){return new Promise(t=>{s("DEBUG:LOG",{value:[...e]},r=>{t(r)})})}function o(e,t,r=""){let n={tag:e};return t instanceof Object?n={tag:e,value:"",...t}:n.value=t,n.hook=r,n}const S={state:{}};function G(e,t,r){return new Function("obj","obj."+t+"="+JSON.stringify(r)+";return obj")(e)}function M(e,t=!0){try{for(const r in e)G(S.state,r,e[r]);return t&&s("STATE:SET",e),!0}catch(r){return console.warn(r),!1}}function d(e){return S.state[e]}let T=!1;function R(e={}){const{state:t={},persisted:r}=e;return new Promise(n=>{if(T)return n(d);s("STATE:INIT",e,a=>{r?S.state=a:S.state=t,T=!0,n(d)})})}function _(){return T=!1,!0}function j(e){return new Promise(t=>{s("STRUCT:INIT",{struct:e},r=>{t(r)})})}const B={success(e){s("UI:TOAST",{type:"success",message:e})},error(e){s("UI:TOAST",{type:"error",message:e})},info(e){s("UI:TOAST",{type:"info",message:e})},warning(e){s("UI:TOAST",{type:"warning",message:e})},log(e){s("UI:TOAST",{type:"log",message:e})}};function m(e,t){return new Promise(r=>{s("CACHE:"+e,{key:t},n=>{r(n)})})}function l(e,t,r){return new Promise(n=>{s("CACHE:"+e,{key:t,value:r},a=>{n(a)})})}const N={getLocal(e){return m("getLocal",e)},saveLocal(e,t){return l("saveLocal",e,t)},removeLocal(e){return l("removeLocal",e)},getSession(e){return m("getSession",e)},saveSession(e,t){return l("saveSession",e,t)},removeSession(e){return l("removeSession",e)}},v={Container(e,t){return e.children=e.children||[],o("Container",e,t)},Text(e,t){return o("Text",e,t)},Tabs(e,t){return o("Tabs",e,t)},Button(e,t){return o("Button",e,t)},ButtonGroup(e,t){return o("ButtonGroup",e,t)},SwitchItem(e,t){return o("SwitchItem",e,t)},Checkbox(e,t){return o("Checkbox",e,t)},SelectItem(e,t){return o("SelectItem",e,t)},InputItem(e,t){return o("InputItem",e,t)},Canvas(e,t){return o("Canvas",e,t)},SliderItem(e,t){return o("SliderItem",e,t)},Divider(){return o("Divider","")},SubHeader(e,t){return o("SubHeader",e,t)},Header(e,t){return o("Header",e,t)},Loading(e,t){return o("Loading",e,t)},Link(e,t){return o("Link",e,t)},Image(e,t){return o("Image",e,t)},Textarea(e,t){return o("Textarea",e,t)},UploadItem(e,t){return o("UploadItem",e,t)},IFstructContainer(e,t){return o("IFstructContainer",e,t)},Code(e,t){return o("Code",e,t)}},F="1.0.4";exports.Version=F;exports.cache=N;exports.call=s;exports.checkAccess=b;exports.checkAccessList=w;exports.components=v;exports.genStruct=o;exports.getCurrentStyle=x;exports.getState=d;exports.init=R;exports.log=H;exports.off=A;exports.on=C;exports.once=h;exports.pullStruct=O;exports.reinit=_;exports.render=j;exports.requestAccess=E;exports.setContext=g;exports.setCurrentStyle=D;exports.setState=M;exports.setStruct=k;exports.suid=U;exports.toast=B;exports.withAccess=y;
