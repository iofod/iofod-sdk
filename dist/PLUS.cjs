"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});let f;const u={},c={},E=["EditorUndo","EditorRedo","EditorPreview","EditorExitPreview"];function m(e,t){if(typeof t=="function"&&(u[e]?u[e].push(t):u[e]=[t],!c[e])){const r=E.includes(e)?e:f+":"+e;c[e]=new BroadcastChannel(r),c[e].onmessage=o=>{u[e].forEach(a=>{a(o.data)})}}}function p(e,t){!u[e]||(typeof t=="function"&&u[e].includes(t)?(u[e].splice(u[e].indexOf(t),1),u[e].length||c[e].close()):(delete u[e],c[e].close(),delete c[e]))}function A(e,t){const r=o=>{t(o),setTimeout(()=>{p(e,r)},0)};m(e,r)}function g(e){f||(f=e)}const I="PLUS:",i=()=>((1+Math.random())*65536|0).toString(16).substring(1),L=()=>i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i();function s(e,t,r){const o=L();return postMessage({type:I+e,payload:t,id:o}),typeof r=="function"&&A(o,r),o}function P(e){return new Promise(t=>{if(!e)return t(!1);s("ACCESS:CHECK",{ql:e},r=>{t(r)})})}function h(){return new Promise(e=>{s("ACCESS:CHECK",{ql:"ALL"},t=>{e(t)})})}function w(e=[]){return new Promise(t=>{s("ACCESS:REQUEST",{list:e},r=>{t(r)})})}async function b(e=[]){const t=await h();return!!(e.every(o=>t.includes(o))||(await w(e)).code==0)}const y=()=>Math.random().toString(36).substring(2);function U(e="W"){return e+Math.round((Date.now()-new Date("2020/02/02").getTime())/1e3)+y().substring(0,3)}function O(e="CTT"){return new Promise(t=>{s("DATA:GET",{path:e},r=>{t(r)})})}function k(e="CTT",t={}){return new Promise(r=>{s("DATA:SET",{path:e,payload:t},o=>{r(o)})})}function x(){return new Promise(e=>{s("DATA:GET_CURRENT_STYLE",{payload:{}},t=>{e(t)})})}function D(e){return new Promise(t=>{s("DATA:SET_CURRENT_STYLE",{payload:e},r=>{t(r)})})}function G(...e){return new Promise(t=>{s("DEBUG:LOG",{value:[...e]},r=>{t(r)})})}function n(e,t,r=""){let o={tag:e};return t instanceof Object?o={tag:e,value:"",...t}:o.value=t,o.hook=r,o}const S={state:{}};function H(e,t,r){return new Function("obj","obj."+t+"="+JSON.stringify(r)+";return obj")(e)}function M(e,t=!0){try{for(const r in e)H(S.state,r,e[r]);return t&&s("STATE:SET",e),!0}catch(r){return console.warn(r),!1}}function d(e){return S.state[e]}let T=!1;function R(e={}){const{state:t={},persisted:r}=e;return new Promise(o=>{if(T)return o(d);s("STATE:INIT",e,a=>{r?S.state=a:S.state=t,T=!0,o(d)})})}function _(){return T=!1,!0}function j(e){return new Promise(t=>{s("STRUCT:INIT",{struct:e},r=>{t(r)})})}const B={success(e){s("UI:TOAST",{type:"success",message:e})},error(e){s("UI:TOAST",{type:"error",message:e})},info(e){s("UI:TOAST",{type:"info",message:e})},warning(e){s("UI:TOAST",{type:"warning",message:e})},log(e){s("UI:TOAST",{type:"log",message:e})}};function C(e,t){return new Promise(r=>{s("CACHE:"+e,{key:t},o=>{r(o)})})}function l(e,t,r){return new Promise(o=>{s("CACHE:"+e,{key:t,value:r},a=>{o(a)})})}const N={getLocal(e){return C("getLocal",e)},saveLocal(e,t){return l("saveLocal",e,t)},removeLocal(e){return l("removeLocal",e)},getSession(e){return C("getSession",e)},saveSession(e,t){return l("saveSession",e,t)},removeSession(e){return l("removeSession",e)}},v={Container(e,t){return e.children=e.children||[],n("Container",e,t)},Text(e,t){return n("Text",e,t)},Tabs(e,t){return n("Tabs",e,t)},Button(e,t){return n("Button",e,t)},ButtonGroup(e,t){return n("ButtonGroup",e,t)},SwitchItem(e,t){return n("SwitchItem",e,t)},Checkbox(e,t){return n("Checkbox",e,t)},SelectItem(e,t){return n("SelectItem",e,t)},OptionGroup(e,t){return n("OptionGroup",e,t)},InputItem(e,t){return n("InputItem",e,t)},Canvas(e,t){return n("Canvas",e,t)},SliderItem(e,t){return n("SliderItem",e,t)},Divider(){return n("Divider","")},SubHeader(e,t){return n("SubHeader",e,t)},Header(e,t){return n("Header",e,t)},Loading(e,t){return n("Loading",e,t)},Link(e,t){return n("Link",e,t)},Image(e,t){return n("Image",e,t)},Textarea(e,t){return n("Textarea",e,t)},UploadItem(e,t){return n("UploadItem",e,t)},IFstructContainer(e,t){return n("IFstructContainer",e,t)},Code(e,t){return n("Code",e,t)},ColorPicker(e,t){return n("ColorPicker",e,t)}},F="1.0.6";exports.Version=F;exports.cache=N;exports.call=s;exports.checkAccess=P;exports.checkAccessList=h;exports.components=v;exports.genStruct=n;exports.getCurrentStyle=x;exports.getState=d;exports.init=R;exports.log=G;exports.off=p;exports.on=m;exports.once=A;exports.pullStruct=O;exports.reinit=_;exports.render=j;exports.requestAccess=w;exports.setContext=g;exports.setCurrentStyle=D;exports.setState=M;exports.setStruct=k;exports.suid=U;exports.toast=B;exports.withAccess=b;
